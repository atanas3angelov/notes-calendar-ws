<!DOCTYPE html>
<html>
    <head>
        <link rel="stylesheet" href="./notes-calendar/notes-calendar.css">
        <script src="./notes-calendar/notes-calendar.js"></script>
    </head>
    <body>
        <script>
            window.onload = function() {
                
                var notesCalendar;

                const fetchNotesData = async(url) => {
                    try {
                        let response = await fetch(url);
                        if (!response.ok) {
                            throw new Error(`Error fetching data @ ${url} . Status: ${response.status}`);
                        }
                        return response.json();
                    }
                    catch(error) {
                        console.error(error);
                    }
                };

                const saveNotesData = async(url, data) => {
                    try {
                        let response = await fetch(url, {
                            method: 'PUT',
                            hearders: { 'Content-Type': 'application/json' },
                            body: JSON.stringify(data)
                        });
                        if (!response.ok) {
                            throw new Error(`Error saving data @ ${url} with PUT. Status: ${response.status}`);
                        }
                    }
                    catch(error) {
                        console.error(error);
                    }
                };

                fetchNotesData("/daynotes/" + 2025 + "/" + 12)
                    .then(notes => {
                        if (notes) {
                                notesCalendar = new NotesCalendar('notes-calendar', 2025, 12, notes);

                                notesCalendar.createNoteBoard('note-board');

                                const callbackSave = (year, month, day, summary, details) => {

                                    const updatedData = {'summary': summary, 'details': details};

                                    saveNotesData("/daynotes/" + year + "/" + month + "/" + day, updatedData);
                                };

                                notesCalendar.defineCallbackSave(callbackSave);
                        }
                    });
            };
        </script>

        <h1>Notes Calendar Preview</h1>
        <div id="notes-calendar"></div>
        <br/>
        <div id="note-board"></div>
    </body>
</html>